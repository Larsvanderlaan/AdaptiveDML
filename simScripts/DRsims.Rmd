---
title: "simsDR"
output: html_document
date: '2023-07-05'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


 


```{r}
 
results <- out
results[, coverage := CI_left <= ATE & CI_right >= ATE]
results[, sd := abs(CI_left -CI_right)/1.96/2]

results
results <- unique(results[, .(sd = mean(sd), se = sd(estimate-ATE), bias = abs(mean(estimate - ATE)), coverage = mean(coverage)), by = c( "misp",   "estimator", "lrnr")])
results[, rmse := sqrt(bias^2 + se^2)]
 
results
```


```{r}
library(data.table)

n_list <- c(  7500 )
pos_list <- c(3)

results <-
  rbindlist(unlist(lapply(n_list, function(n){
    unlist(lapply(pos_list, function(pos) {
  lapply(c(0), function(misp) {
    try({
      
    key <- paste0("DR_iter=", "1000", "_n=", n, "_pos=", pos )
   data <- fread(paste0("../simResultsDR/sim_results_", key, ".csv"))
   data$n <- n
   data$pos <- pos
   return(data)
    })
    return(data.table())
  })
}), recursive = F)
}), recursive = F))

 
results[, coverage := CI_left <= ATE & CI_right >= ATE]
results[, sd := abs(CI_left -CI_right)/1.96/2]
results
 results <- unique(results[, .(sd = mean(sd), se = sd(estimate-ATE), bias = abs(mean(estimate - ATE)), coverage = mean(coverage)), by = c("pos", "n", "misp",   "estimator", "lrnr")])
results[, rmse := sqrt(bias^2 + se^2)]
 
 results

```



```{r}

results[n >= 1000 & pos == 4e-02]

```
